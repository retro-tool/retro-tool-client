---
apiVersion: v1
kind: Service
metadata:
  name: "<%= defined?(name) ? name : %Q{#{app_name}-#{target_role}} %>"
  namespace: #{@namespace}
  labels:
    app: "<%= defined?(name) ? name : %Q{#{app_name}-#{target_role}} %>"
    appName: "<%= app_name if defined?(app_name) %>"
    targetRole: "<%= target_role if defined?(target_role) %>"
spec:
  ports:
  - port: 80
  selector:
    app: "<%= defined?(name) ? name : %Q{#{app_name}-#{target_role}} %>"
  type: ClusterIP
